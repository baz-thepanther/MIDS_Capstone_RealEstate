## Score Calculation ##

# Dropped PM2.5 because too few complete rows
subset = data.frame(Parks, AVERAGE.of.Temperature..1981.2010.Annual.Average..in.F, AVERAGE.of.Precipitation..1981.2010.Annual.Total..in.Inches, renter_occupied, Construction, Finance_and_Insurance, Professional._Scientific._and_Technical_Services)

complete_records = complete.cases(subset)

#Equal Weighted
equal_weighted_raw = (Parks/max(Parks, na.rm=TRUE) + AVERAGE.of.Temperature..1981.2010.Annual.Average..in.F/max(AVERAGE.of.Temperature..1981.2010.Annual.Average..in.F, na.rm=TRUE) + AVERAGE.of.Precipitation..1981.2010.Annual.Total..in.Inches/max(AVERAGE.of.Precipitation..1981.2010.Annual.Total..in.Inches, na.rm=TRUE) + renter_occupied/max(renter_occupied, na.rm=TRUE) + Construction/max(Construction, na.rm=TRUE) + Finance_and_Insurance/max(Finance_and_Insurance, na.rm=TRUE) + Professional._Scientific._and_Technical_Services/max(Professional._Scientific._and_Technical_Services, na.rm=TRUE))/7*100

edist = max(equal_weighted_raw, na.rm=TRUE) - min(equal_weighted_raw, na.rm=TRUE)
equal_weighted = (equal_weighted_raw - min(equal_weighted_raw, na.rm=TRUE)) / edist * 100

#Regression Weighted
reg_weighted_raw = 6.887*Parks/max(Parks, na.rm=TRUE) + (-6.051)*AVERAGE.of.Temperature..1981.2010.Annual.Average..in.F/max(AVERAGE.of.Temperature..1981.2010.Annual.Average..in.F, na.rm=TRUE) + (-4.7)*AVERAGE.of.Precipitation..1981.2010.Annual.Total..in.Inches/max(AVERAGE.of.Precipitation..1981.2010.Annual.Total..in.Inches, na.rm=TRUE) + 3.565*renter_occupied/max(renter_occupied, na.rm=TRUE) + (-3.596)*Construction/max(Construction, na.rm=TRUE) + (-6.579)*Finance_and_Insurance/max(Finance_and_Insurance, na.rm=TRUE) + 6.784*Professional._Scientific._and_Technical_Services/max(Professional._Scientific._and_Technical_Services, na.rm=TRUE)

rdist = max(reg_weighted_raw, na.rm=TRUE) - min(reg_weighted_raw, na.rm=TRUE)
reg_weighted = (reg_weighted_raw - min(reg_weighted_raw, na.rm=TRUE)) / rdist * 100


##Final Scores
scores = cbind(zip[complete_records==TRUE], equal_weighted[complete_records==TRUE], reg_weighted[complete_records==TRUE])
scores

       [zip]   [equal]  [regression]
  [1,] 94010  58.882387  21.454566
  [2,] 94018  14.906463  28.834682
  [3,] 94019  20.402873  21.066235
  [4,] 94020  12.658649  13.796613
  [5,] 94021   9.947783  11.552526
  [6,] 94022  35.455390  22.782672
  [7,] 94027  20.370839  39.147641
  [8,] 94030  26.497197  21.858446
  [9,] 94037  11.694058  23.008726
 [10,] 94038  11.612799  21.470282
 [11,] 94041  54.513237  85.120416
 [12,] 94043  40.458207  49.856742
 [13,] 94044  37.304063  20.296131
 [14,] 94061  41.681524  33.716890
 [15,] 94063  49.945849  21.033322
 [16,] 94066  35.600100  24.699166
 [17,] 94070  49.715813  23.571959
 [18,] 94074   0.000000  15.481766
 [19,] 94085  41.503320  67.123272
 [20,] 94086  39.739697  55.256712
 [21,] 94102  67.691212  86.345014
 [22,] 94103  89.460821  88.839031
 [23,] 94107 100.000000 100.000000
 [24,] 94114  67.246339  82.121458
 [25,] 94116  45.495889  35.546894
 [26,] 94117  62.820220  79.576821
 [27,] 94122  76.460786  67.575534
 [28,] 94124  58.835467  22.623094
 [29,] 94127  42.523282  57.082643
 [30,] 94128  16.240476  33.670934
 [31,] 94132  28.999282  43.128558
 [32,] 94158  52.343269  80.246940
 [33,] 94301  56.820289  61.844387
 [34,] 94304  19.094375  30.300568
 [35,] 94305  28.429511  53.751895
 [36,] 94306  35.996711  53.843554
 [37,] 94401  37.943772  40.559907
 [38,] 94501  52.128854  40.616100
 [39,] 94502  25.238642  38.289585
 [40,] 94505   7.588845  26.211996
 [41,] 94506  19.691756  25.294953
 [42,] 94508  26.307948  17.031017
 [43,] 94509  24.322711  19.176078
 [44,] 94513  35.432567  19.014014
 [45,] 94514  12.590062  28.154790
 [46,] 94515  26.711544  13.209445
 [47,] 94517   9.133477  16.829211
 [48,] 94518  25.890730  24.619133
 [49,] 94519  14.138777  26.364836
 [50,] 94520  47.700415   7.870479
 [51,] 94523  39.350558  28.630000
 [52,] 94526  38.181435  14.298181
 [53,] 94527  15.906658  31.828640
 [54,] 94528  10.149053  31.215006
 [55,] 94531  16.939048  30.839195
 [56,] 94536  31.605509  38.903836
 [57,] 94538  56.370665  34.452477
 [58,] 94541  30.648233  29.138749
 [59,] 94544  26.457412  24.587231
 [60,] 94545  39.433589  18.604185
 [61,] 94548   5.290174  31.726780
 [62,] 94550  38.218052  12.885606
 [63,] 94551  29.219935  17.439478
 [64,] 94555  20.820306  43.341077
 [65,] 94558  58.287843  14.685048
 [66,] 94559  37.515512  19.791091
 [67,] 94560  25.063194  29.726161
 [68,] 94561  13.959138  18.944497
 [69,] 94562  26.153432  26.223815
 [70,] 94566  38.251328  25.298265
 [71,] 94567   9.488359   6.133285
 [72,] 94569  22.547062  44.079385
 [73,] 94573  25.562329  25.484530
 [74,] 94574  32.870895  16.121885
 [75,] 94576  22.206441  19.028827
 [76,] 94577  52.204631  25.976468
 [77,] 94579  15.070020  32.899359
 [78,] 94580  22.826447  42.555140
 [79,] 94581  27.612874  28.908516
 [80,] 94587  24.364766  30.838135
 [81,] 94588  39.788066  30.521892
 [82,] 94599  18.554001  23.311862
 [83,] 94603  19.634018  30.660395
 [84,] 94607  42.629020  35.118003
 [85,] 94612  84.172547  90.177839
 [86,] 94614  25.894476  49.528459
 [87,] 94617  49.630329  75.890699
 [88,] 94621  29.998014  29.754225
 [89,] 94662  46.301203  80.608273
 [90,] 94703  31.202950  39.745313
 [91,] 94704  60.823036  79.244366
 [92,] 94708  28.239527  36.741460
 [93,] 94709  54.983283  76.492201
 [94,] 94720  43.303462  64.629184
 [95,] 94804  29.119639  24.440756
 [96,] 94805  21.032729  29.567110
 [97,] 94901  81.323036  17.923495
 [98,] 94922  34.364619  14.328880
 [99,] 94923  23.419546   9.029412
[100,] 94931  24.750879  23.467627
[101,] 94939  54.009390  36.863261
[102,] 94951  21.358423  27.213173
[103,] 94954  34.796371  11.280259
[104,] 94957  21.879763  30.709635
[105,] 94960  42.324029  22.436835
[106,] 95001  15.805704  41.599323
[107,] 95005  29.536126   7.714057
[108,] 95007  21.242981   8.005056
[109,] 95008  99.689059  46.216112
[110,] 95010  36.149893  30.155938
[111,] 95018  35.495787  15.733857
[112,] 95019  11.987637  26.791478
[113,] 95020  40.693893  14.053917
[114,] 95021  12.517698  29.460317
[115,] 95023  27.073218  19.775764
[116,] 95024   6.670818  31.958036
[117,] 95030  43.680581  56.217768
[118,] 95032  30.204024  25.739054
[119,] 95033  35.466569  29.996421
[120,] 95037  38.866361  13.754085
[121,] 95041  27.364860  12.576703
[122,] 95045  12.423695  36.069526
[123,] 95046  13.163016  19.487326
[124,] 95050  56.799018  53.052632
[125,] 95052  37.763583  68.254364
[126,] 95053  18.912180  42.770249
[127,] 95062  49.185740  26.780592
[128,] 95063  29.982572  38.213725
[129,] 95065  26.093696  24.068124
[130,] 95066  36.066113  11.423954
[131,] 95073  24.896123  14.907137
[132,] 95075   2.807107  29.271894
[133,] 95077  16.200259  34.950290
[134,] 95110  36.965063  34.881358
[135,] 95112  87.044965  60.603007
[136,] 95121  21.625210  31.403196
[137,] 95124  41.194158  25.044318
[138,] 95135  16.127627  29.327938
[139,] 95138  17.433530  31.852362
[140,] 95148  21.354735  26.786440
[141,] 95154  18.867724  36.916094
[142,] 95206  14.008487  29.534062
[143,] 95207  31.869081  21.248292
[144,] 95213   9.132172  32.011962
[145,] 95215  15.629217  26.510445
[146,] 95231  12.076359  32.541502
[147,] 95240  34.870558  13.906704
[148,] 95241  16.790096  34.780296
[149,] 95242  22.210443  21.116502
[150,] 95253  12.878790  30.397793
[151,] 95258  24.018871  47.912647
[152,] 95267  12.786686  30.539157
[153,] 95269  11.658161  29.447633
[154,] 95297  12.497381  30.616741
[155,] 95304  11.712003  23.738611
[156,] 95336  19.423031  22.386812
[157,] 95376  29.222342  29.351351
[158,] 95378   4.161724  28.417974
[159,] 95401  55.092611  25.884780
[160,] 95402  31.102001  38.982687
[161,] 95403  60.240741   9.259978
[162,] 95404  51.579483  16.641472
[163,] 95405  46.079920  43.637936
[164,] 95406  30.317347  39.380474
[165,] 95419  13.336195   4.357261
[166,] 95421  10.912870  12.470116
[167,] 95430  16.095580   0.000000
[168,] 95431  22.010484  29.688599
[169,] 95433  24.226688  31.423149
[170,] 95436  22.072058  14.806332
[171,] 95439  27.767905  21.795508
[172,] 95441  20.156744   9.767056
[173,] 95444  21.558032  18.244458
[174,] 95448  42.782125   6.734071
[175,] 95450  15.362977  19.271375
[176,] 95465  23.045516   3.992194
[177,] 95471  10.595253   7.460751
[178,] 95472  55.112450   9.708627
[179,] 95473  27.663687  23.224710
[180,] 95486   9.714845   6.235121
[181,] 95487   5.066532  15.941375
[182,] 95492  36.343741   8.569966
